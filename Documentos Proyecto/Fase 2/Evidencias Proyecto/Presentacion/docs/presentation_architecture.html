<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portafolio de T√≠tulo | Arquitectura ms-recetas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            /* subtle paper-like gradient */
            background: linear-gradient(180deg, #fbfbfd 0%, #f1f5f9 60%);
            color: #0f172a;
        }
        /* Presentation / print friendly styles */
        .slide { padding: 2rem 0; }
        .slide h2 { margin-bottom: 0.5rem; }
        .separator { width: 6rem; height: 1px; background: #e6e9ef; margin: 0.6rem auto 1rem; }
        @media print {
            body { background: white; }
            .no-print { display: none !important; }
            .slide { page-break-after: always; }
            header, footer, nav { display: none; }
        }
        .ascii-diagram {
            font-family: ui-monospace, SFMono-Regular, 'SF Mono', 'Segoe UI Mono', 'Roboto Mono', 'Courier New', monospace;
            white-space: pre;
            font-size: 0.82em;
            line-height: 1.35;
            color: #0f172a;
        }
        .ascii-wrap {
            background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(249,250,252,0.85));
            border: 1px solid rgba(15,23,42,0.04);
            padding: 1rem;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(2,6,23,0.06);
        }
        .brand-gradient {
            background: linear-gradient(90deg, #5b21b6 0%, #ec4899 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        /* Diagram sizing: uniform for architecture, ER and auth diagrams */
        .diagram-img {
            display: block;
            margin-left: auto;
            margin-right: auto;
            max-width: 900px;
            max-height: 460px;
            width: auto;
            height: auto;
            object-fit: contain;
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold text-slate-900">Portafolio de T√≠tulo</h1>
            <nav class="hidden md:flex space-x-8">
                <a href="#intro" class="text-slate-600 hover:text-indigo-600 transition">Introducci√≥n</a>
                <a href="#arquitectura" class="text-slate-600 hover:text-indigo-600 transition">Arquitectura</a>
                <a href="#endpoints" class="text-slate-600 hover:text-indigo-600 transition">Endpoints</a>
                <a href="#detalles" class="text-slate-600 hover:text-indigo-600 transition">Detalles Clave</a>
            </nav>
        </div>
    </header>

    <main class="container mx-auto px-6 py-12">

        <!-- Secci√≥n de Introducci√≥n -->
        <section id="intro" class="text-center mb-20">
            <h2 class="text-5xl font-extrabold mb-4">Proyecto <span class="brand-gradient">ms-recetas</span></h2>
            <p class="text-lg text-slate-700 max-w-3xl mx-auto">
                ms-recetas es una API RESTful contenerizada, lista para producci√≥n sobre Docker/Kubernetes, que proporciona un backend modular y escalable para cat√°logos de recetas; prioriza la seguridad (BCrypt para hashing de contrase√±as, JWT para autorizaci√≥n y gesti√≥n segura de secretos), la resiliencia operativa (pipelines reproducibles, backups autom√°ticos y pruebas de restore) y la integraci√≥n con servicios externos (pagos, webhooks y colas). Adem√°s ofrece funcionalidades sociales (favoritos, comentarios, valoraciones) y soporte para migraciones h√≠bridas desde sistemas legados, permitiendo un crecimiento r√°pido con bajo riesgo operativo.
            </p>
            <div class="mt-6">
                <h3 class="sr-only">Explicaci√≥n de los componentes principales</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl mx-auto">
                    <div class="bg-white p-5 rounded-xl shadow-lg border border-slate-200">
                        <h4 class="font-semibold text-lg mb-2">Frontend</h4>
                        <p class="text-slate-700 text-sm">Cliente multiplataforma (<strong>React</strong>) que consume la API v√≠a HTTPS; maneja UI, validaciones y experiencia offline limitada.</p>
                    </div>
                    <div class="bg-white p-5 rounded-xl shadow-lg border border-slate-200">
                        <h4 class="font-semibold text-lg mb-2">Backend</h4>
                        <p class="text-slate-700 text-sm">Servicio <strong>Spring Boot</strong> que implementa l√≥gica de negocio, autorizaciones (JWT) y orquesta integraciones externas (pagos, chatbot).</p>
                    </div>
                    <div class="bg-white p-5 rounded-xl shadow-lg border border-slate-200">
                        <h4 class="font-semibold text-lg mb-2">Base de Datos</h4>
                        <p class="text-slate-700 text-sm">PostgreSQL con backups peri√≥dicos y estrategia de recuperaci√≥n; esquema relacional optimizado para b√∫squedas por pa√≠s/categor√≠a.</p>
                    </div>
                </div>
            </div>
            
        </section>

        <!-- Secci√≥n de Arquitectura -->
        <section id="arquitectura" class="mb-20">
            <h2 class="text-5xl font-bold text-center mb-10">Diagrama de Arquitectura de Software</h2>
            <div class="w-24 h-px bg-slate-200 mx-auto mb-6" aria-hidden="true"></div>
            
            
            <div class="ascii-wrap overflow-x-auto">
                    <div class="modern-diagram w-full">
                    
                    <div class="mt-6 text-center">
                        <!-- Mostrar imagen del diagrama de arquitectura (SVG embebido como imagen) -->
                        <img id="arch-img" src="architecture_diagram.svg" alt="Diagrama de Arquitectura" class="diagram-img rounded-lg shadow-lg border border-slate-200 mb-4" />
                        <div class="max-w-3xl mx-auto text-left text-slate-700 mb-6">
                            <h3 class="font-semibold mb-2">Explicaci√≥n del diagrama de arquitectura</h3>
                            <p class="text-sm">Este diagrama muestra el flujo desde el cliente hasta los servicios y la base de datos. Puntos clave:</p>
                            <ul class="list-disc pl-5 mt-2 text-sm space-y-1">
                                <li><strong>Cliente ‚Üí Reverse Proxy:</strong> Todas las solicitudes pasan por TLS; el reverse proxy centraliza certificados y permite rate-limiting y protecci√≥n contra tr√°fico malicioso.</li>
                                <li><strong>Backend / Servicios:</strong> Contenedores desplegados con principio de 12-factor; las integraciones (pagos, chatbot) se consumen mediante webhooks y colas para resiliencia.</li>
                                <li><strong>Base de Datos y Operaciones:</strong> Postgres en volumen persistente; backups automatizados (pg_dump + rotaci√≥n) y alertas de integridad de datos.</li>
                                <li><strong>CI/CD:</strong> Pipelines construyen im√°genes, ejecutan tests y despliegan etapas en staging/production usando etiquetas de imagen (BACKEND_IMAGE).</li>
                            </ul>
                        </div>

                        <!-- ER Diagram below architecture -->
                        <div class="mt-6">
                            <h3 class="text-3xl font-semibold text-slate-800 mb-2">Diagrama ER (resumen)</h3>
                            <img src="er_diagram_actualizado.png" alt="Diagrama ER" class="mx-auto max-w-full rounded-lg shadow border border-slate-200" style="max-height:360px; width:auto;"/>
                            <div class="mt-4 max-w-3xl mx-auto text-left text-slate-700">
                                <h4 class="font-semibold mb-2">Explicaci√≥n del Diagrama ER</h4>
                                <p class="text-sm">Resumen ejecutivo del modelo de datos (Postgres 15):</p>
                                <ul class="list-disc pl-5 mt-2 text-sm space-y-1">
                                    <li><strong>usuario</strong> (id_usr): credenciales y perfil.</li>
                                    <li><strong>receta</strong> (id_receta): entidad central ‚Äî autor (id_usr), categor√≠a (id_cat), pa√≠s (id_pais).</li>
                                    <li><strong>referencias</strong>: categoria, pais, perfil (1:N); receta_del_dia por fecha.</li>
                                    <li><strong>engagement</strong>: comentario, me_gusta, favorito, estrella vinculados a receta/usuario.</li>
                                    <li><strong>pagos</strong>: donacion y sesion_pago para intents y reconciliaci√≥n con proveedores.</li>
                                </ul>
                                <p class="text-sm mt-3 font-semibold">Recomendaciones</p>
                                <ul class="list-disc pl-5 mt-2 text-sm space-y-1">
                                    <li>√çndices en <code>receta(id_usr,id_cat,id_pais)</code> y <code>sesion_pago(session_id)</code>.</li>
                                    <li>Pol√≠ticas claras de constraints/cascadas y plan de migraci√≥n para tablas legadas.</li>
                                    <li>Evaluar normalizar ingredientes si se requiere b√∫squeda avanzada.</li>
                                </ul>
                                <p class="text-sm mt-2">Esquema exportado a <code>docs/</code> (tables/columns/fks/pks) para auditor√≠a.</p>
                            </div>
                        </div>

                        <!-- Authentication flow diagram (after database) -->
                        <div class="mt-6 text-center">
                            <h3 class="text-3xl font-semibold text-slate-800 mb-2">Diagrama de Autenticaci√≥n</h3>
                            <p class="text-sm text-slate-600 mb-3">Flujo de inicio de sesi√≥n y gesti√≥n de tokens JWT. A continuaci√≥n se resumen las garant√≠as y el comportamiento.</p>
                            <img src="auth_flow.svg" alt="Diagrama de Autenticaci√≥n" class="mx-auto max-w-full rounded-lg shadow border border-slate-200" style="max-height:320px; width:auto;"/>
                            
                            <div class="mt-4 max-w-3xl mx-auto text-left text-slate-700">
                                <h4 class="font-semibold mb-2">Explicaci√≥n del flujo de autenticaci√≥n</h4>
                                <ul class="list-disc pl-5 mt-2 text-sm space-y-1">
                                    <li><strong>Login:</strong> el usuario env√≠a credenciales; el backend valida y emite un JWT (acceso) y opcionalmente un Refresh Token seguro (long-lived).</li>
                                    <li><strong>Almacenamiento seguro:</strong> recomendamos guardar el Refresh Token en una cookie HttpOnly y el JWT de acceso en memoria; evitar almacenamiento en localStorage sin protecci√≥n.</li>
                                    <li><strong>Renovaci√≥n:</strong> el cliente solicita renovaci√≥n usando el Refresh Token; el backend valida la sesi√≥n y emite un nuevo JWT, invalidando tokens revocados seg√∫n sea necesario.</li>
                                    <li><strong>Logout / Revocaci√≥n:</strong> implementar lista de revocaci√≥n (blacklist) o reducir TTL del access token y acompasar con invalidaci√≥n de Refresh Tokens en la base de datos.</li>
                                    <li><strong>Seguridad adicional:</strong> rate-limiting, bloqueo tras intentos fallidos y verificaci√≥n de firma HMAC en webhooks para proteger endpoints p√∫blicos.</li>
                                </ul>
                                <p class="text-sm mt-2">Estos patrones equilibran seguridad y usabilidad: tokens cortos para acceso, refresh tokens controlados para sesiones largas y revocaci√≥n de tokens para incidentes.</p>
                            </div>
                        </div>

                        
                        
                    </div>
                </div>
            </div>
        </section>

        <!-- Resumen y conclusiones (movido al final del documento) -->

        <!-- Secci√≥n de Endpoints (resumen extra√≠do de ENDPOINTS-COMPLETOS.md) -->
        <section id="endpoints" class="mb-20">
            <h2 class="text-3xl font-bold text-center mb-8">Endpoints Principales de la API</h2>
            <p class="text-center text-sm text-slate-600 max-w-3xl mx-auto mb-6">Resumen operativo de los endpoints m√°s usados. Para la lista completa y ejemplos detallados, ver <a href="ENDPOINTS-COMPLETOS.md" class="text-indigo-600 underline">docs/ENDPOINTS-COMPLETOS.md</a>.</p>

            <!-- (Secci√≥n de conclusiones movida al final del documento) -->
            <div class="flex flex-col sm:flex-row gap-6 max-w-6xl mx-auto">
                <!-- Auth -->
                <div class="bg-white p-4 rounded-lg shadow border">
                    <h3 class="font-semibold mb-2">üîê Autenticaci√≥n</h3>
                    <p class="text-sm text-slate-700">Endpoints para login y registro (JWT).</p>
                    <ul class="mt-3 text-sm list-disc pl-5 space-y-1">
                        <li><code>POST /auth/login</code> ‚Äî Login con email/password, devuelve JWT y usuario.</li>
                        <li><code>POST /auth/register</code> ‚Äî Registro de usuarios.</li>
                    </ul>
                </div>

                <!-- Usuarios -->
                <div class="bg-white p-4 rounded-lg shadow border">
                    <h3 class="font-semibold mb-2">üë• Usuarios</h3>
                    <p class="text-sm text-slate-700">Gesti√≥n de cuentas; algunos endpoints protegidos por roles (ADMIN/SUP).</p>
                    <ul class="mt-3 text-sm list-disc pl-5 space-y-1">
                        <li><code>GET /usuarios</code> ‚Äî Listar usuarios (requiere rol administrativo).</li>
                        <li><code>GET /usuarios/{id}</code> ‚Äî Obtener usuario por id.</li>
                        <li><code>POST /usuarios</code> ‚Äî Crear usuario (bcrypt para contrase√±a).</li>
                        <li><code>PUT /usuarios/{id}</code> ‚Äî Actualizar usuario.</li>
                        <li><code>DELETE /usuarios/{id}</code> ‚Äî Soft delete.</li>
                    </ul>
                </div>

                <!-- Categor√≠as -->
                <div class="bg-white p-4 rounded-lg shadow border">
                    <h3 class="font-semibold mb-2">üìÇ Categor√≠as</h3>
                    <p class="text-sm text-slate-700">CRUD completo para categorizar recetas.</p>
                    <ul class="mt-3 text-sm list-disc pl-5 space-y-1">
                        <li><code>GET /categorias</code> ‚Äî Listar categor√≠as.</li>
                        <li><code>POST /categorias</code> ‚Äî Crear categor√≠a.</li>
                        <li><code>PUT /categorias/{id}</code> ‚Äî Actualizar categor√≠a.</li>
                        <li><code>DELETE /categorias/{id}</code> ‚Äî Eliminar (soft delete).</li>
                    </ul>
                </div>

                <!-- Paises -->
                <div class="bg-white p-4 rounded-lg shadow border">
                    <h3 class="font-semibold mb-2">üåç Pa√≠ses</h3>
                    <p class="text-sm text-slate-700">CRUD para listados y filtrado por pa√≠s.</p>
                    <ul class="mt-3 text-sm list-disc pl-5 space-y-1">
                        <li><code>GET /paises</code></li>
                        <li><code>GET /paises/{id}</code></li>
                        <li><code>POST /paises</code></li>
                        <li><code>PUT /paises/{id}</code></li>
                        <li><code>DELETE /paises/{id}</code></li>
                    </ul>
                </div>

                <!-- Recetas (resumen) -->
                <div class="bg-white p-4 rounded-lg shadow border md:col-span-2">
                    <h3 class="font-semibold mb-2">üçΩÔ∏è Recetas (resumen)</h3>
                    <p class="text-sm text-slate-700">Entidad central con CRUD, ingredientes y m√∫ltiples endpoints de interacci√≥n.</p>
                    <div class="mt-3 grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
                        <div>
                            <ul class="list-disc pl-5 space-y-1">
                                <li><code>GET /recetas</code> ‚Äî Listar recetas.</li>
                                <li><code>GET /recetas/{id}</code> ‚Äî Obtener receta por id.</li>
                                <li><code>POST /recetas</code> ‚Äî Crear receta (con ingredientes).</li>
                                <li><code>PUT /recetas/{id}</code> ‚Äî Actualizar receta.</li>
                                <li><code>DELETE /recetas/{id}</code> ‚Äî Soft delete.</li>
                            </ul>
                        </div>
                        <div>
                            <ul class="list-disc pl-5 space-y-1">
                                <li><code>GET /recetas/carrusel</code> ‚Äî Top 8 recetas (carrusel).</li>
                                <li><code>GET /recetas/trending</code> ‚Äî Recetas populares recientes.</li>
                                <li><code>GET /recetas/del-dia</code> ‚Äî Receta del d√≠a.</li>
                                <li><code>GET /recetas/{id}/ingredientes</code> ‚Äî Ingredientes de receta.</li>
                                <li><code>POST/PUT/DELETE /recetas/{id}/ingredientes</code> ‚Äî Gesti√≥n de ingredientes.</li>
                            </ul>
                        </div>
                    </div>
                    <p class="text-xs text-slate-500 mt-4">Total aproximado de endpoints: ~42 (ver <a href="ENDPOINTS-COMPLETOS.md" class="text-indigo-600 underline">docs/ENDPOINTS-COMPLETOS.md</a> para detalle).</p>
                </div>
            </div>
        </section>

        <!-- Secci√≥n de Detalles Clave -->
        <section id="detalles">
            <h2 class="text-3xl font-bold text-center mb-10">Detalles Clave de Implementaci√≥n</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                    <h3 class="font-bold text-xl text-slate-900 mb-3">Seguridad y autenticaci√≥n</h3>
                    <p class="text-slate-700">Uso de <strong>BCrypt</strong> para hashing de contrase√±as (configurar work factor acorde al hardware; cost ‚â• 10 recomendado) y <strong>JWT</strong> para autorizaci√≥n. Recomendaciones operativas:</p>
                    <ul class="list-disc pl-5 mt-3 text-sm text-slate-700 space-y-1">
                        <li>Firmar JWT con algoritmo fuerte (RS256 recomendado para infra con claves asim√©tricas).</li>
                        <li>Access tokens de corta duraci√≥n (p.ej. 5‚Äì15 minutos) y Refresh Tokens revocables almacenados en cookies <code>HttpOnly</code> y <code>Secure</code>.</li>
                        <li>Implementar revocaci√≥n de tokens (blacklist) y endpoints para logout/invalicaci√≥n de refresh tokens.</li>
                        <li>Rate-limiting, bloqueo por intentos fallidos y MFA para acciones sensibles.</li>
                        <li>Owner-check a nivel de recurso y validaci√≥n de scopes/roles en controladores cr√≠ticos.</li>
                    </ul>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                    <h3 class="font-bold text-xl text-slate-900 mb-3">Integraciones externas</h3>
                    <p class="text-slate-700">Servicios externos (pagos, chatbot, anal√≠tica) deben integrarse de forma desacoplada. Patrones recomendados:</p>
                    <ul class="list-disc pl-5 mt-3 text-sm text-slate-700 space-y-1">
                        <li>Usar colas durables (RabbitMQ/Kafka) con Dead-Letter Queues (DLQ) y retries con backoff exponencial.</li>
                        <li>Para webhooks: verificar firma HMAC/PKI, validar timestamps y usar idempotency keys para evitar duplicados.</li>
                        <li>Implementar circuit-breakers para degradaci√≥n controlada y timeouts razonables en llamadas externas.</li>
                        <li>Saneamiento y validaci√≥n estricta de payloads externos; l√≠mites por IP y cabeceras de firma en endpoints p√∫blicos.</li>
                    </ul>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                    <h3 class="font-bold text-xl text-slate-900 mb-3">Operaciones y DevOps</h3>
                    <p class="text-slate-700">Observabilidad, backups y gesti√≥n de secretos son cr√≠ticos para producci√≥n. Resumen de pr√°cticas:</p>
                    <ul class="list-disc pl-5 mt-3 text-sm text-slate-700 space-y-1">
                        <li>Logging estructurado (JSON) con <em>correlation-id</em>; exposar m√©tricas (Prometheus) y traces (OpenTelemetry).</li>
                        <li>Health/readiness probes para orquestadores y pipelines CI/CD que generen artefactos inmutables (Docker images).</li>
                        <li>Gesti√≥n de secretos con Vault o Key Vault; evitar credenciales en repositorio o ficheros no cifrados.</li>
                        <li>Backups autom√°ticos (pg_dump o WAL-based PITR), rotaci√≥n y pruebas peri√≥dicas de restore; documentar el procedimiento de recovery.</li>
                        <li>Migraciones gestionadas (Flyway/Liquibase) y deshabilitar herramientas de desarrollo en producci√≥n.</li>
                    </ul>
                </div>
            </div>

            <!-- Recomendaciones y criterios: implementados/movidos a documentaci√≥n operativa -->
        </section>

        <!-- Resumen ejecutivo consolidado en la secci√≥n de Arquitectura y ER arriba. Eliminada la duplicaci√≥n. -->

        <!-- Resumen y conclusiones -->
        <section id="conclusiones" class="my-20">
            <h2 class="text-3xl font-bold text-center mb-6">Resumen y conclusiones</h2>
            <div class="max-w-4xl mx-auto text-slate-700">
                <p class="text-sm">ms-recetas entrega una base s√≥lida para lanzar productos de contenido gastron√≥mico: un backend escalable, modelos de datos relacionales, y un conjunto de endpoints completos para interacci√≥n y monetizaci√≥n.</p>
                <ul class="list-disc pl-5 mt-4 text-sm space-y-1">
                    <li><strong>Preparado para producci√≥n:</strong> im√°genes reproducibles, CI/CD y backups automatizados.</li>
                    <li><strong>Seguridad:</strong> autenticaci√≥n con JWT y manejo seguro de credenciales; se recomiendan pol√≠ticas de expiraci√≥n y revocaci√≥n de tokens.</li>
                    <li><strong>Operaciones:</strong> observabilidad y pruebas de restore para garantizar disponibilidad y recuperaci√≥n.</li>
                    <li><strong>Escalabilidad:</strong> arquitectura contenerizada, colas para procesos as√≠ncronos y separaci√≥n de responsabilidades del backend.</li>
                </ul>
                <p class="text-sm mt-4">Siguientes pasos recomendados:</p>
                <ol class="list-decimal pl-5 mt-2 text-sm space-y-1">
                    <li>Ejecutar pruebas de restore de backups en un entorno de staging y documentar el procedimiento.</li>
                    <li>Configurar gesti√≥n de secretos (Vault / Key Vault) y rotaci√≥n de claves JWT peri√≥dica.</li>
                    <li>Generar PNG optimizados de los diagramas y revisar la presentaci√≥n en pantalla completa antes de la reuni√≥n con inversores.</li>
                    <li>Automatizar la verificaci√≥n de endpoints mediante tests de integraci√≥n en CI.</li>
                </ol>
                <p class="text-sm mt-4 font-semibold">Conclusi√≥n:</p>
                <p class="text-sm">El proyecto est√° en condici√≥n de avanzar a despliegue controlado. Con las mejoras operativas y las pruebas recomendadas completadas, ms-recetas ofrece una plataforma madura para crecer y captar usuarios de manera segura.</p>
            </div>
        </section>
