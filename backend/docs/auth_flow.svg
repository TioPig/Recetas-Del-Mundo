<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="639px" preserveAspectRatio="xMidYMid meet" style="width:875px;height:639px;background:#FFFFFF;" version="1.1" viewBox="0 0 1075 785" width="875px" zoomAndPan="magnify"><title>Flujo de Autenticaci&#243;n - API Recetas del Mundo</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="317.3652" x="379.9119" y="29.5332">Flujo de Autenticaci&#243;n - API Recetas del Mundo</text><rect fill="none" height="125.2422" style="stroke:#000000;stroke-width:1.5;" width="748.665" x="319.5239" y="259.625"/><rect fill="none" height="125.2422" style="stroke:#000000;stroke-width:1.5;" width="627.3965" x="319.5239" y="459.5703"/><g><title>Usuario</title><rect fill="#000000" fill-opacity="0.00000" height="582.3516" width="8" x="213.1206" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="217" x2="217" y1="121.2188" y2="703.5703"/></g><g><title>Cliente .UI.</title><rect fill="#000000" fill-opacity="0.00000" height="582.3516" width="8" x="367.9204" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="371.5239" x2="371.5239" y1="121.2188" y2="703.5703"/></g><g><title>Spring Boot .API REST.</title><rect fill="#000000" fill-opacity="0.00000" height="582.3516" width="8" x="638.3237" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="642.2412" x2="642.2412" y1="121.2188" y2="703.5703"/></g><g><title>DB .Postgres.</title><rect fill="#000000" fill-opacity="0.00000" height="582.3516" width="8" x="881.9653" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="885.0103" x2="885.0103" y1="121.2188" y2="703.5703"/></g><g><title>Redis . Session</title><rect fill="#000000" fill-opacity="0.00000" height="582.3516" width="8" x="998.5547" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1001.9204" x2="1001.9204" y1="121.2188" y2="703.5703"/></g><g class="participant participant-head" data-participant="Usuario"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.2412" x="190" y="118.1426">Usuario</text><ellipse cx="217.1206" cy="52.1094" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M217.1206,60.1094 L217.1206,87.1094 M204.1206,68.1094 L230.1206,68.1094 M217.1206,87.1094 L204.1206,102.1094 M217.1206,87.1094 L230.1206,102.1094" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Usuario"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.2412" x="190" y="717.1035">Usuario</text><ellipse cx="217.1206" cy="728.6797" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M217.1206,736.6797 L217.1206,763.6797 M204.1206,744.6797 L230.1206,744.6797 M217.1206,763.6797 L204.1206,778.6797 M217.1206,763.6797 L230.1206,778.6797" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Client"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84.793" x="329.5239" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.793" x="336.5239" y="110.1426">Cliente (UI)</text></g><g class="participant participant-tail" data-participant="Client"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84.793" x="329.5239" y="702.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.793" x="336.5239" y="724.1035">Cliente (UI)</text></g><g class="participant participant-head" data-participant="API"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164.165" x="560.2412" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.165" x="567.2412" y="110.1426">Spring Boot (API REST)</text></g><g class="participant participant-tail" data-participant="API"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164.165" x="560.2412" y="702.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.165" x="567.2412" y="724.1035">Spring Boot (API REST)</text></g><g class="participant participant-head" data-participant="DB"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.9102" x="835.0103" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.9102" x="842.0103" y="110.1426">DB (Postgres)</text></g><g class="participant participant-tail" data-participant="DB"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.9102" x="835.0103" y="702.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.9102" x="842.0103" y="724.1035">DB (Postgres)</text></g><g class="participant participant-head" data-participant="Redis"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111.2686" x="946.9204" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.2686" x="953.9204" y="110.1426">Redis / Session</text></g><g class="participant participant-tail" data-participant="Redis"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111.2686" x="946.9204" y="702.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.2686" x="953.9204" y="724.1035">Redis / Session</text></g><g class="message" data-participant-1="Usuario" data-participant-2="Client"><polygon fill="#181818" points="359.9204,149.5703,369.9204,153.5703,359.9204,157.5703,363.9204,153.5703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="217.1206" x2="365.9204" y1="153.5703" y2="153.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.7998" x="224.1206" y="148.7139">Introduce credenciales</text></g><g class="message" data-participant-1="Client" data-participant-2="API"><polygon fill="#181818" points="630.3237,179.9219,640.3237,183.9219,630.3237,187.9219,634.3237,183.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="371.9204" x2="636.3237" y1="183.9219" y2="183.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.6079" x="378.9204" y="179.0654">POST /auth/login {email,password}</text></g><g class="message" data-participant-1="API" data-participant-2="DB"><polygon fill="#181818" points="873.9653,210.2734,883.9653,214.2734,873.9653,218.2734,877.9653,214.2734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="642.3237" x2="879.9653" y1="214.2734" y2="214.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.6416" x="649.3237" y="209.417">Verificar usuario y contrase&#241;a (bcrypt)</text></g><g class="message" data-participant-1="DB" data-participant-2="API"><polygon fill="#181818" points="653.3237,240.625,643.3237,244.625,653.3237,248.625,649.3237,244.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="647.3237" x2="884.9653" y1="244.625" y2="244.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.3989" x="659.3237" y="239.7686">Usuario v&#225;lido / hash</text></g><path d="M319.5239,259.625 L379.6948,259.625 L379.6948,267.9766 L369.6948,277.9766 L319.5239,277.9766 L319.5239,259.625" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="125.2422" style="stroke:#000000;stroke-width:1.5;" width="748.665" x="319.5239" y="259.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15.1709" x="334.5239" y="274.1201">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="114.3398" x="394.6948" y="273.0439">[credenciales v&#225;lidas]</text><g class="message" data-participant-1="API" data-participant-2="Redis"><polygon fill="#181818" points="990.5547,296.3281,1000.5547,300.3281,990.5547,304.3281,994.5547,300.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="642.3237" x2="996.5547" y1="300.3281" y2="300.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.0298" x="649.3237" y="295.4717">Crear sesi&#243;n / token (opcional)</text></g><g class="message" data-participant-1="API" data-participant-2="Client"><polygon fill="#181818" points="382.9204,326.6797,372.9204,330.6797,382.9204,334.6797,378.9204,330.6797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="376.9204" x2="641.3237" y1="330.6797" y2="330.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.7144" x="388.9204" y="325.8232">200 OK + JWT / session cookie</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="319.5239" x2="1068.189" y1="339.6797" y2="339.6797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="124.1152" x="324.5239" y="351.0986">[credenciales inv&#225;lidas]</text><g class="message" data-participant-1="API" data-participant-2="Client"><polygon fill="#181818" points="382.9204,372.8672,372.9204,376.8672,382.9204,380.8672,378.9204,376.8672" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="376.9204" x2="641.3237" y1="376.8672" y2="376.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.6289" x="388.9204" y="372.0107">401 Unauthorized</text></g><g class="message" data-participant-1="Client" data-participant-2="API"><polygon fill="#181818" points="630.3237,410.2188,640.3237,414.2188,630.3237,418.2188,634.3237,414.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="371.9204" x2="636.3237" y1="414.2188" y2="414.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246.4033" x="378.9204" y="409.3623">Acceso a recurso protegido (Authorization)</text></g><g class="message" data-participant-1="API" data-participant-2="Redis"><polygon fill="#181818" points="990.5547,440.5703,1000.5547,444.5703,990.5547,448.5703,994.5547,444.5703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="642.3237" x2="996.5547" y1="444.5703" y2="444.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="649.3237" y="439.7139">Validar sesi&#243;n / token</text></g><path d="M319.5239,459.5703 L379.6948,459.5703 L379.6948,467.9219 L369.6948,477.9219 L319.5239,477.9219 L319.5239,459.5703" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="125.2422" style="stroke:#000000;stroke-width:1.5;" width="627.3965" x="319.5239" y="459.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15.1709" x="334.5239" y="474.0654">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="71.5054" x="394.6948" y="472.9893">[token v&#225;lido]</text><g class="message" data-participant-1="API" data-participant-2="DB"><polygon fill="#181818" points="873.9653,496.2734,883.9653,500.2734,873.9653,504.2734,877.9653,500.2734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="642.3237" x2="879.9653" y1="500.2734" y2="500.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.7935" x="649.3237" y="495.417">Obtener usuario / permisos</text></g><g class="message" data-participant-1="API" data-participant-2="Client"><polygon fill="#181818" points="382.9204,526.625,372.9204,530.625,382.9204,534.625,378.9204,530.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="376.9204" x2="641.3237" y1="530.625" y2="530.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.8735" x="388.9204" y="525.7686">200 / recurso</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="319.5239" x2="946.9204" y1="539.625" y2="539.625"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="48.8877" x="324.5239" y="551.0439">[inv&#225;lido]</text><g class="message" data-participant-1="API" data-participant-2="Client"><polygon fill="#181818" points="382.9204,572.8125,372.9204,576.8125,382.9204,580.8125,378.9204,576.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="376.9204" x2="641.3237" y1="576.8125" y2="576.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54.2153" x="388.9204" y="571.9561">401 / 403</text></g><path d="M5,596.8125 L5,687.8125 L739,687.8125 L739,606.8125 L729,596.8125 L5,596.8125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M729,596.8125 L729,606.8125 L739,606.8125 L729,596.8125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.2871" x="11" y="615.3076">Recomendaciones:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246.3589" x="11" y="631.6592">- Usar JWT con expiraci&#243;n y refresh token.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.6543" x="11" y="648.0107">- Proteger endpoints cr&#237;ticos con roles (`perfil`).</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="713.1211" x="11" y="664.3623">- JWT: actualmente HS256 (HMAC) en el proyecto. Almacenar `JWT_SECRET` en un vault o variables de entorno seguras.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="558.4541" x="11" y="680.7139">- Implementar revocaci&#243;n/blacklist para refresh tokens (ej. Redis) y validar `iss`, `aud`, `exp`, `jti`.</text></g></svg>




